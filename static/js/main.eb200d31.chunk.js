(this["webpackJsonpweather-app"]=this["webpackJsonpweather-app"]||[]).push([[0],{10:function(e,t,a){e.exports=a(16)},15:function(e,t,a){},16:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),c=a(9),l=a.n(c),r=(a(15),a(3)),s=a(4),o=a(6),h=a(5),u=a(1),d=a(7),m=(a(2),function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,i=new Array(n),c=0;c<n;c++)i[c]=arguments[c];return(a=Object(o.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(i)))).state={deleteBtn:null},a.hadleClick=function(e){a.props.onCityClick(e.target)},a.handleDeleteBtnClick=function(e){e.preventDefault(),a.props.onDeleteBtnClick(e.target)},a.handleMouseEnter=function(e){a.setState({deleteBtn:!0})},a.handleMouseLeave=function(e){a.setState({deleteBtn:!1})},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.state.deleteBtn,t=this.props,a=t.id,n=t.name;return+this.props.activeCityId===a?i.a.createElement("li",{className:"city-wrapper city__active",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},i.a.createElement("div",{id:a,className:"city",onClick:this.hadleClick},n),e&&i.a.createElement("button",{id:a,className:"delete-city",onClick:this.handleDeleteBtnClick},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c")):i.a.createElement("li",{className:"city-wrapper",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},i.a.createElement("div",{id:a,className:"city",onClick:this.hadleClick},n),e&&i.a.createElement("button",{id:a,className:"delete-city",onClick:this.handleDeleteBtnClick},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"))}}]),t}(i.a.Component)),p=function(e){var t=function(t){e.onDeleteCityBtnClick(t)},a=e.data,n=e.onCityClick,c=e.activeCityId;return i.a.createElement("nav",{className:"cities-wrapper"},i.a.createElement("h2",{className:"cities-wrapper__label"},"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0433\u043e\u0440\u043e\u0434"),i.a.createElement("ul",{className:"cities"},a.map((function(e){return i.a.createElement(m,{key:e.id,id:e.id,name:e.city,onCityClick:n,onDeleteBtnClick:t,activeCityId:c})}))))},v=function(e){var t=+e.errStatus,a=e.errGeo,n=e.activeCity;return i.a.createElement("div",{className:"weather-display"},i.a.createElement("div",{className:"weather-display__error"},i.a.createElement("h2",null,"\u041e\u0448\u0438\u0431\u043a\u0430!"),t>=400&&t<500&&i.a.createElement("p",null,"\u041e\u0448\u0438\u0431\u043a\u0430 ",t," (Not Found).\u0413\u043e\u0440\u043e\u0434 ",i.a.createElement("span",{className:"weather-display__error-city"},n)," \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d \u0432 \u0431\u0430\u0437\u0435.",i.a.createElement("br",null),"\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0432\u0432\u0435\u0441\u0442\u0438 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043d\u0430 \u0430\u043d\u0433\u043b\u0438\u0439\u0441\u043a\u043e\u043c \u0438\u043b\u0438 \u043f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u043e\u0438\u0441\u043a\u043e\u0432\u044b\u0439 \u0437\u0430\u043f\u0440\u043e\u0441"),t>=500&&t<600&&i.a.createElement("p",null,"\u041e\u0448\u0438\u0431\u043a\u0430 \u043d\u0430 \u0441\u0442\u043e\u0440\u043e\u043d\u0435 \u0441\u0435\u0440\u0432\u0435\u0440\u0430, \u043e\u0448\u0438\u0431\u043a\u0430 ",t,". \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043f\u043e\u0437\u0436\u0435."),a&&i.a.createElement("p",null,"\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 \u043e \u043c\u0435\u0441\u0442\u043e\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u0438.",i.a.createElement("br",null),"\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u044c \u043f\u043e\u0437\u0436\u0435 \u0438\u043b\u0438 \u043c\u043e\u0436\u0435\u0442\u0435 \u0432\u0432\u0435\u0441\u0442\u0438 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0433\u043e\u0440\u043e\u0434\u0430 \u0432 \u0441\u0442\u0440\u043e\u043a\u0443 \u043f\u043e\u0438\u0441\u043a\u0430.",i.a.createElement("br",null),i.a.createElement("hr",null),"\u041e\u0448\u0438\u0431\u043a\u0430: ",a.code,". ",a.message)))},y=function(e){return i.a.createElement("div",{className:"weather-display"},i.a.createElement("div",{className:"load-5"},i.a.createElement("div",{className:"ring-2"},i.a.createElement("div",{className:"ball-holder"},i.a.createElement("div",{className:"ball"})))))},f=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(h.a)(t).call(this,e))).fetchData=a.fetchData.bind(Object(u.a)(a)),a.state={weatherData:null,err:null,loading:!0},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"fetchData",value:function(e){var t=this,a="https://api.openweathermap.org/data/2.5/weather?q="+e+"&units=metric&lang=ru&APPID=".concat("ef598dd48091a3a2eb6a63ef6c4d75b2");this.setState({loading:!0}),fetch(a).then((function(e){if(e.ok)return e.json();throw e.status})).then((function(e){t.setState({weatherData:e,loading:!1,err:null})})).catch((function(e){console.warn("\u0414\u0430\u043d\u043d\u044b\u0435 \u043d\u0435 \u0431\u044b\u043b\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u044b, \u043e\u0448\u0438\u0431\u043a\u0430: "+e),t.setState({err:e})}))}},{key:"componentDidMount",value:function(){var e=this.props,t=e.activeCity,a=e.weatherDataByGeo;a?this.setState({weatherData:a,loading:!1}):this.fetchData(t)}},{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.activeCity,n=t.weatherDataByGeo;e.activeCity!==a&&this.fetchData(a),e.weatherDataByGeo!==n&&this.setState({weatherData:n,loading:!1})}},{key:"render",value:function(){var e=this.state,t=e.weatherData,a=e.err,n=e.loading,c=this.props.activeCity;if(a)return i.a.createElement(v,{errStatus:a,activeCity:c});if(n)return i.a.createElement(y,null);var l=t.weather[0],r="https://openweathermap.org/img/wn/".concat(l.icon,".png");return i.a.createElement("div",{className:"weather-display"},i.a.createElement("h2",{className:"city-status"},"".concat(l.main," in ").concat(t.name),i.a.createElement("img",{src:r,alt:l.description,title:l.description})),i.a.createElement("div",{className:"weather-info"},i.a.createElement("p",{className:"weather-info__item"},"\u0422\u0435\u043c\u043f\u0435\u0440\u0430\u0442\u0443\u0440\u0430: ",t.main.temp,"\xb0"),i.a.createElement("p",{className:"weather-info__item"},"\u041f\u043e \u043e\u0449\u0443\u0449\u0435\u043d\u0438\u044e: ",t.main.feels_like,"\xb0"),i.a.createElement("p",{className:"weather-info__item"},"\u0412\u0435\u0442\u0435\u0440: ",t.wind.speed," \u043c/\u0441"),i.a.createElement("p",{className:"weather-info__item"},"\u0421\u0442\u0430\u0442\u0443\u0441: ",l.description),i.a.createElement("p",{className:"weather-info__item"},"\u0414\u0430\u0432\u043b\u0435\u043d\u0438\u0435: ",(.75006375541921*t.main.pressure).toFixed(2)," \u043c\u043c \u0440\u0442. \u0441\u0442."),i.a.createElement("p",{className:"weather-info__item"},"\u0412\u043b\u0430\u0436\u043d\u043e\u0441\u0442\u044c: ",t.main.humidity,"%"),i.a.createElement("p",{className:"weather-info__item"},"\u041a\u043e\u043e\u0440\u0434\u0438\u043d\u0430\u0442\u044b: ","[".concat(t.coord.lat,", ").concat(t.coord.lon,"]; ").concat(t.sys.country))))}}]),t}(i.a.Component),C=function(e){return i.a.createElement("div",{className:"search-wrapper"},i.a.createElement("div",{className:"search"},i.a.createElement("input",{type:"text",className:"search_input",onChange:function(t){t.preventDefault(),e.onChange(t.target)},value:e.value,placeholder:"\u041f\u043e\u0433\u043e\u0434\u0430 \u0432 \u0432\u0430\u0448\u0435\u043c \u0433\u043e\u0440\u043e\u0434\u0435...",onKeyDown:function(t){e.onKeyDown(t)}}),i.a.createElement("button",{id:"searchBtn",className:"search_btn",onClick:function(t){t.preventDefault(),e.onClick(t)}}),i.a.createElement("div",{className:"search_location",onClick:function(t){e.onLocationClick(t)}},i.a.createElement("img",{className:"search_location-img",src:"https://img.icons8.com/color/48/000000/gps-device.png",alt:"\u041c\u043e\u0451 \u043c\u0435\u0441\u0442\u043e\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u0435",title:"\u041c\u043e\u0451 \u043c\u0435\u0441\u0442\u043e\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u0435"}))),"no value"===e.searchErr&&i.a.createElement("div",{className:"search-err-message"},i.a.createElement("span",null,"\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u0432\u0435\u0441\u0442\u0438\u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0433\u043e\u0440\u043e\u0434\u0430")),"duplicate"===e.searchErr&&i.a.createElement("div",{className:"search-err-message"},i.a.createElement("span",null,"\u0414\u0430\u043d\u043d\u044b\u0439 \u0433\u043e\u0440\u043e\u0434 \u0443\u0436\u0435 \u0431\u044b\u043b \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d \u0440\u0430\u043d\u0435\u0435")))},g=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(h.a)(t).call(this,e))).handleCityClick=a.handleCityClick.bind(Object(u.a)(a)),a.handleInputChange=a.handleInputChange.bind(Object(u.a)(a)),a.handleSearchBtnClick=a.handleSearchBtnClick.bind(Object(u.a)(a)),a.handleDeleteCityBtnClick=a.handleDeleteCityBtnClick.bind(Object(u.a)(a)),a.handleLocationClick=a.handleLocationClick.bind(Object(u.a)(a)),a.validate=a.validate.bind(Object(u.a)(a)),a.fetchDataByGeo=a.fetchDataByGeo.bind(Object(u.a)(a)),a.geoLocation=a.geoLocation.bind(Object(u.a)(a)),a.state={cities:localStorage.getItem("cities")?JSON.parse(localStorage.getItem("cities")):[],activeCityId:null,value:"",searchErr:"",weatherDataByGeo:null,loading:!1,errGeo:null},a}return Object(d.a)(t,e),Object(s.a)(t,[{key:"fetchDataByGeo",value:function(e,t){var a=this,n="https://api.openweathermap.org/data/2.5/weather?lat="+e+"&lon="+t+"&units=metric&lang=ru&APPID=".concat("ef598dd48091a3a2eb6a63ef6c4d75b2");this.setState({loading:!0}),fetch(n).then((function(e){if(e.ok)return e.json();throw e.status})).then((function(e){a.setState({weatherDataByGeo:e,loading:!1})})).catch((function(e){console.warn("\u0414\u0430\u043d\u043d\u044b\u0435 \u043d\u0435 \u0431\u044b\u043b\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u044b, \u043e\u0448\u0438\u0431\u043a\u0430: "+e)}))}},{key:"geoLocation",value:function(){var e=this;if("geolocation"in navigator){console.log("navigator");navigator.geolocation.getCurrentPosition((function(t){console.log(t.coords),e.fetchDataByGeo(t.coords.latitude,t.coords.longitude)}),(function(t){console.log(t.code,t.message),e.setState({errGeo:t})}),{enableHighAccuracy:!0,maximumAge:0,timeout:27e3})}else alert("\u0413\u0435\u043e\u043b\u0430\u043a\u0430\u0446\u0438\u044f \u043d\u0435 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u0432\u0430\u0448\u0438\u043c \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u043e\u043c.\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0434\u0440\u0443\u0433\u043e\u0439 \u0431\u0440\u0430\u0443\u0437\u0435\u0440 \u0438\u043b\u0438 \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u0435 \u0432\u0430\u0448 \u0431\u0440\u0430\u0443\u0437\u0435\u0440 \u0434\u043e \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0439 \u0432\u0435\u0440\u0441\u0438\u0438.")}},{key:"validate",value:function(e){var t=this.state.cities;if(!e)return"no value";if(t)for(var a=0;a<t.length;a++)if(t[a].city===e.trim())return"duplicate";return"true"}},{key:"handleCityClick",value:function(e){this.setState({activeCityId:e.id,errGeo:null,searchErr:""})}},{key:"handleInputChange",value:function(e){this.setState({value:e.value})}},{key:"handleSearchBtnClick",value:function(e){if("Enter"===e.key||"searchBtn"===e.target.id){var t=this.state,a=t.cities,n=t.value,i=n.slice(0,1).toUpperCase()+n.slice(1).toLowerCase(),c=this.validate(i),l=a.slice();if("true"===c){var r={id:a.length>0?a[a.length-1].id+1:1,city:i};l.push(r),localStorage.setItem("cities",JSON.stringify(l)),this.setState({cities:JSON.parse(localStorage.getItem("cities")),activeCityId:r.id,value:"",searchErr:"",errGeo:null})}else"duplicate"===c?this.setState({value:"",searchErr:"duplicate",errGeo:null}):this.setState({searchErr:"no value",errGeo:null})}}},{key:"handleDeleteCityBtnClick",value:function(e){for(var t=this.state.cities.slice(),a=0;a<t.length;a++)t[a].id===+e.id&&(t.splice(a,1),localStorage.setItem("cities",JSON.stringify(t)));this.setState({activeCityId:e.id-1,cities:JSON.parse(localStorage.getItem("cities"))})}},{key:"handleLocationClick",value:function(e){this.state.errGeo&&this.setState({errGeo:null}),this.geoLocation()}},{key:"componentDidMount",value:function(){alert('\n    \u0414\u043b\u044f \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0439 \u0440\u0430\u0431\u043e\u0442\u044b \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0434\u0430\u0442\u044c \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u0435 \u043d\u0430 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0433\u0435\u043e\u0434\u0430\u043d\u043d\u044b\u043c.\n    (\u041d\u0430\u0436\u043c\u0438\u0442\u0435 "\u0440\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c" \u0432 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u043c \u0432\u0441\u043f\u043b\u044b\u0432\u0430\u044e\u0449\u0435\u043c \u043e\u043a\u043d\u0435 \u0432 \u043f\u0440\u0430\u0432\u043e\u043c \u0443\u0433\u043b\u0443 \u043f\u043e\u0438\u0441\u043a\u043e\u0432\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u0438 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0430).\n    \u042d\u0442\u043e \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u043c\u0435\u0441\u0442\u043e\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0438 \u043f\u043e\u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u0433\u043e \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044f\n    \u043c\u0435\u0441\u0442\u043e\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u043f\u0440\u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u0435.\n    '),this.geoLocation()}},{key:"componentDidUpdate",value:function(e,t){var a=this.state,n=a.cities,i=a.weatherDataByGeo;if(t.weatherDataByGeo!==i){for(var c=!1,l=0;l<n.length;l++)n[l].city===i.name&&(c=!0,this.setState({activeCityId:n[l].id}));if(!c){var r=n.slice(),s={id:n.length>0?n[n.length-1].id+1:1,city:i.name};r.push(s),localStorage.setItem("cities",JSON.stringify(r)),this.setState({cities:JSON.parse(localStorage.getItem("cities")),activeCityId:s.id})}}}},{key:"render",value:function(){var e,t=this.state,a=t.cities,n=t.activeCityId,c=t.value,l=t.searchErr,r=this.state,s=r.weatherDataByGeo,o=r.loading,h=r.errGeo;return a.length&&a.forEach((function(t){return t.id===+n?e=t.city:""})),i.a.createElement(i.a.Fragment,null,i.a.createElement("header",{className:"header"},i.a.createElement("h1",{className:"header__name"},"Weather App")),i.a.createElement("hr",{className:"header__line"}),i.a.createElement("main",{className:"main-wrapper"},i.a.createElement(C,{value:c,onChange:this.handleInputChange,onClick:this.handleSearchBtnClick,searchErr:l,onKeyDown:this.handleSearchBtnClick,onLocationClick:this.handleLocationClick}),i.a.createElement("div",{className:"main-info"},i.a.createElement(p,{data:a,onCityClick:this.handleCityClick,activeCityId:n,onDeleteCityBtnClick:this.handleDeleteCityBtnClick}),!o&&!h&&(n||s?i.a.createElement(f,{activeCity:e,weatherDataByGeo:s}):i.a.createElement("div",{className:"weather-display"},i.a.createElement("p",{className:"weather-display__loader"},"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0433\u043e\u0440\u043e\u0434"))),o&&i.a.createElement(y,null),h&&i.a.createElement(v,{errGeo:h}))))}}]),t}(i.a.Component);l.a.render(i.a.createElement(g,null),document.getElementById("root"))},2:function(e,t,a){}},[[10,1,2]]]);
//# sourceMappingURL=main.eb200d31.chunk.js.map