{"version":3,"sources":["components/CityBtn.js","components/Cities.js","components/RequestError.js","components/Loader.js","components/WeatherDisplay.js","components/AddCity.js","App.js","index.js"],"names":["CityBtn","state","deleteBtn","hadleClick","e","props","onCityClick","target","handleDeleteBtnClick","preventDefault","onDeleteBtnClick","handleMouseEnter","setState","handleMouseLeave","this","id","name","activeCityId","className","onMouseEnter","onMouseLeave","onClick","React","Component","Cities","onDeleteCityBtnClick","data","map","element","key","city","RequestError","errStatus","errGeo","activeCity","code","message","Loader","WeatherDisplay","fetchData","bind","weatherData","err","loading","URL","fetch","then","response","ok","json","status","catch","console","warn","weatherDataByGeo","prevProps","weather","weatherIcon","icon","main","src","alt","description","title","temp","feels_like","wind","speed","pressure","toFixed","humidity","coord","lat","lon","sys","country","AddCity","type","onChange","value","placeholder","onKeyDown","onLocationClick","searchErr","App","handleCityClick","handleInputChange","handleSearchBtnClick","handleDeleteCityBtnClick","handleLocationClick","validate","fetchDataByGeo","geoLocation","cities","localStorage","getItem","JSON","parse","latitude","longitude","navigator","log","geolocation","getCurrentPosition","position","coords","enableHighAccuracy","maximumAge","timeout","alert","i","length","trim","input","event","validValue","slice","toUpperCase","toLowerCase","validateResult","citiesClone","newCity","push","setItem","stringify","splice","prevState","duplicate","forEach","item","Fragment","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.eb200d31.chunk.js","sourcesContent":["import React from 'react';\r\nimport '../App.css';\r\n\r\n//Компонент рендерит кнопку с названием города в navbar-e.\r\n//Так же рендерится кнопка \"Удалить\" при наведении на CityBtn\r\nclass CityBtn extends React.Component {\r\n  state = {\r\n    deleteBtn: null\r\n  }\r\n\r\n  hadleClick = (e) => {\r\n   this.props.onCityClick(e.target);\r\n  }\r\n\r\n  handleDeleteBtnClick = (e) => {\r\n    e.preventDefault();\r\n    this.props.onDeleteBtnClick(e.target);\r\n  }\r\n\r\n  handleMouseEnter = (e) => {\r\n    this.setState({deleteBtn: true});\r\n  }\r\n\r\n  handleMouseLeave = (e) => {\r\n    this.setState({deleteBtn: false});\r\n  }\r\n\r\n  render () {\r\n    const {deleteBtn} = this.state;\r\n    const {id, name} = this.props;\r\n    const activeCityId = +this.props.activeCityId;\r\n    return (\r\n      activeCityId === id ?\r\n        <li className=\"city-wrapper city__active\" onMouseEnter={this.handleMouseEnter} onMouseLeave={this.handleMouseLeave}>\r\n          <div id={id} className=\"city\" onClick={this.hadleClick}>\r\n            {name}\r\n          </div>\r\n          {deleteBtn && <button id={id} className=\"delete-city\" onClick={this.handleDeleteBtnClick}>Удалить</button>}\r\n        </li>\r\n        :\r\n        <li className=\"city-wrapper\" onMouseEnter={this.handleMouseEnter} onMouseLeave={this.handleMouseLeave}>\r\n          <div id={id} className=\"city\" onClick={this.hadleClick}>\r\n            {name}\r\n          </div>\r\n          {deleteBtn && <button id={id} className=\"delete-city\" onClick={this.handleDeleteBtnClick}>Удалить</button>}\r\n        </li>\r\n  )\r\n  }\r\n}\r\n\r\nexport {CityBtn};","import React from 'react';\r\nimport {CityBtn} from './CityBtn';\r\nimport '../App.css';\r\n\r\n//Компонент, который является navbar-ом, в котором рендерятся кнопки CityBtn\r\nconst Cities = (props) => {\r\n  const handleDeleteBtnClick = (deleteBtn) => {\r\n    props.onDeleteCityBtnClick(deleteBtn);\r\n  }\r\n\r\n  const {data, onCityClick, activeCityId} = props;\r\n\r\n  return (\r\n    <nav className=\"cities-wrapper\">\r\n      <h2 className=\"cities-wrapper__label\">Выберите город</h2>\r\n      <ul className=\"cities\">\r\n        {data.map(element => \r\n            <CityBtn \r\n              key={element.id} \r\n              id={element.id}\r\n              name={element.city}\r\n              onCityClick={onCityClick}\r\n              onDeleteBtnClick={handleDeleteBtnClick}\r\n              activeCityId={activeCityId}\r\n            />\r\n        )}\r\n      </ul>\r\n    </nav>\r\n  )\r\n\r\n}\r\n\r\nexport {Cities};","import React from 'react';\r\nimport '../App.css';\r\n\r\n//Компонент, который рендерит ошибку, если не получены данные при запросе на API\r\nconst RequestError = (props) => {\r\n const errStatus = +props.errStatus;\r\n const errGeo = props.errGeo;\r\n const activeCity = props.activeCity;\r\n  return (\r\n    <div className=\"weather-display\">\r\n      <div className=\"weather-display__error\">\r\n        <h2>Ошибка!</h2>\r\n        {\r\n          (errStatus >= 400 && errStatus < 500)  &&  \r\n          <p>\r\n            Ошибка {errStatus} (Not Found).Город <span className='weather-display__error-city'>{activeCity}</span> не найден в базе.<br/>\r\n            Попробуйте ввести название на английском или попробуйте изменить поисковый запрос\r\n          </p>\r\n        }\r\n        {\r\n          (errStatus >= 500 && errStatus < 600)  && \r\n          <p>Ошибка на стороне сервера, ошибка {errStatus}. Попробуйте позже.</p>\r\n        }\r\n        {\r\n          errGeo && \r\n          <p>\r\n            Произошла ошибка при запросе данных о местоположении.<br/>\r\n            Попробуйте повторить позже или можете ввести название города\r\n            в строку поиска.<br/><hr/>\r\n            Ошибка: {errGeo.code}. {errGeo.message}\r\n          </p>\r\n        }\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport {RequestError};","import React from 'react';\r\nimport '../App.css';\r\n\r\nconst Loader = (props) => {\r\n  return (\r\n    <div className=\"weather-display\">\r\n      <div className=\"load-5\">\r\n        <div className=\"ring-2\">\r\n          <div className=\"ball-holder\">\r\n            <div className=\"ball\"></div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport {Loader};","import React from 'react';\r\nimport {RequestError} from './RequestError';\r\nimport {Loader} from './Loader';\r\nimport '../App.css';\r\n\r\n//Компонент показывает данные о погоде в выбарнном городе\r\nclass WeatherDisplay extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.fetchData = this.fetchData.bind(this);\r\n    this.state = {\r\n      weatherData: null,\r\n      err: null,\r\n      loading: true\r\n    }\r\n  }\r\n\r\n  //Запрос на API по имени выбранного города в navbar. activeCity получаем из props.\r\n  fetchData(activeCity) {\r\n    const APPID = 'ef598dd48091a3a2eb6a63ef6c4d75b2'\r\n    const URL = 'https://api.openweathermap.org/data/2.5/weather?q=' + \r\n                activeCity + `&units=metric&lang=ru&APPID=${APPID}`;\r\n\r\n    this.setState({loading: true});\r\n\r\n    fetch(URL).then(response => {\r\n      if (response.ok) {\r\n        return response.json(); \r\n      } else {\r\n        throw response.status\r\n      }\r\n    })\r\n    .then(data => {\r\n      this.setState({\r\n        weatherData: data,\r\n        loading: false,\r\n        err: null\r\n      });\r\n    })\r\n    .catch(err => {\r\n      console.warn('Данные не были получены, ошибка: ' + err);\r\n      this.setState({\r\n        err: err\r\n      })\r\n    }) \r\n  }\r\n\r\n  //Когда компонент примонтирован, если есть данные о погоде полученые из местоположения пользователя то\r\n  //компонент отображает их, в противном случае делает запрос на api по активному городу\r\n  componentDidMount() {\r\n    const {activeCity, weatherDataByGeo} = this.props;\r\n    \r\n    weatherDataByGeo ? \r\n    this.setState({weatherData: weatherDataByGeo, loading: false}) :\r\n    this.fetchData(activeCity);    \r\n  }\r\n\r\n  //делает запрос на api, если был выбран другой город или если есть данные о погоде по местоположению то отображает их\r\n  componentDidUpdate(prevProps) {\r\n    const {activeCity, weatherDataByGeo} = this.props;\r\n    \r\n    prevProps.activeCity !== activeCity && this.fetchData(activeCity);\r\n    prevProps.weatherDataByGeo !== weatherDataByGeo && this.setState({weatherData: weatherDataByGeo, loading: false});\r\n  }\r\n\r\n  render() {\r\n    const {weatherData, err, loading} = this.state;\r\n    const {activeCity} = this.props;\r\n    \r\n    if (err) return <RequestError errStatus={err} activeCity={activeCity}/>;\r\n    else if (loading) return <Loader/>;\r\n\r\n    const weather = weatherData.weather[0];\r\n    const weatherIcon = `https://openweathermap.org/img/wn/${weather.icon}.png`\r\n    \r\n    return (\r\n      <div className=\"weather-display\">\r\n        <h2 className=\"city-status\">\r\n          {`${weather.main} in ${weatherData.name}`}\r\n          <img \r\n            src={weatherIcon} \r\n            alt={weather.description} \r\n            title={weather.description}/>  \r\n        </h2>\r\n        <div className=\"weather-info\">\r\n          <p className=\"weather-info__item\">Температура: {weatherData.main.temp}°</p>\r\n          <p className=\"weather-info__item\">По ощущению: {weatherData.main.feels_like}°</p>\r\n          <p className=\"weather-info__item\">Ветер: {weatherData.wind.speed} м/с</p>\r\n          <p className=\"weather-info__item\">Статус: {weather.description}</p>\r\n          <p className=\"weather-info__item\">Давление: {\r\n            /*перевод давления из атм в мм.рт.ст*/\r\n            (weatherData.main.pressure *  0.75006375541921).toFixed(2)\r\n          } мм рт. ст.</p>\r\n          <p className=\"weather-info__item\">Влажность: {weatherData.main.humidity}%</p>\r\n          <p className=\"weather-info__item\">Координаты: {`[${weatherData.coord.lat}, ${weatherData.coord.lon}]; ${weatherData.sys.country}`}</p>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport {WeatherDisplay}","import React from 'react';\r\nimport '../App.css';\r\n\r\n//Компонент рендерит поисковую строку и сообщения о невалидных данных\r\nconst AddCity = (props) => {\r\n  const handleChange = (e) => {\r\n    e.preventDefault();\r\n    props.onChange(e.target);\r\n  }\r\n\r\n  const handleClick = (e) => {\r\n    e.preventDefault();\r\n    props.onClick(e);\r\n  }\r\n\r\n  const handleKeyDown = (e) => {\r\n    props.onKeyDown(e);\r\n  }\r\n\r\n  const handleLocationClick = (e) => {\r\n    props.onLocationClick(e);\r\n  }\r\n\r\n  return (\r\n    <div className=\"search-wrapper\">\r\n      <div className=\"search\">\r\n        <input \r\n          type=\"text\" \r\n          className=\"search_input\"\r\n          onChange={handleChange}\r\n          value={props.value}\r\n          placeholder=\"Погода в вашем городе...\"\r\n          onKeyDown={handleKeyDown}\r\n        />\r\n        <button id=\"searchBtn\" className=\"search_btn\" onClick={handleClick}></button>\r\n        <div className=\"search_location\" onClick={handleLocationClick}>\r\n          <img \r\n            className=\"search_location-img\" \r\n            src=\"https://img.icons8.com/color/48/000000/gps-device.png\" \r\n            alt='Моё местоположение'\r\n            title='Моё местоположение'\r\n          />\r\n        </div>\r\n\t\t  </div>\r\n    {props.searchErr === 'no value' && <div className=\"search-err-message\"><span>Необходимо ввестиназвание города</span></div>}\r\n    {props.searchErr === 'duplicate' && <div className=\"search-err-message\"><span>Данный город уже был добавлен ранее</span></div>}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport {AddCity};","import React from 'react';\r\nimport {Cities} from './components/Cities';\r\nimport {WeatherDisplay} from './components/WeatherDisplay';\r\nimport {AddCity} from './components/AddCity';\r\nimport { Loader } from './components/Loader';\r\nimport { RequestError } from './components/RequestError';\r\nimport './App.css'\r\n\r\nclass App extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.handleCityClick = this.handleCityClick.bind(this);\r\n    this.handleInputChange = this.handleInputChange.bind(this);\r\n    this.handleSearchBtnClick = this.handleSearchBtnClick.bind(this);\r\n    this.handleDeleteCityBtnClick = this.handleDeleteCityBtnClick.bind(this);\r\n    this.handleLocationClick = this.handleLocationClick.bind(this);\r\n    this.validate = this.validate.bind(this);\r\n    this.fetchDataByGeo = this.fetchDataByGeo.bind(this);\r\n    this.geoLocation = this.geoLocation.bind(this);\r\n\r\n    this.state = {\r\n      cities: localStorage.getItem('cities') ? JSON.parse(localStorage.getItem('cities')) : [],\r\n      activeCityId: null,\r\n      value: '',\r\n      searchErr: '',\r\n      weatherDataByGeo: null,\r\n      loading: false,\r\n      errGeo: null\r\n    }\r\n  }\r\n\r\n  //Делает запрос на API по значениям координат, полученных из navigator.location\r\n  fetchDataByGeo(latitude, longitude) {    \r\n    const APPID = 'ef598dd48091a3a2eb6a63ef6c4d75b2'\r\n    const URL = 'https://api.openweathermap.org/data/2.5/weather?lat=' + \r\n          latitude + '&lon=' + longitude + `&units=metric&lang=ru&APPID=${APPID}`;\r\n\r\n    this.setState({loading: true});\r\n\r\n    fetch(URL).then(response => {\r\n      if (response.ok) {\r\n        return response.json(); \r\n      } else {\r\n        throw response.status\r\n      }\r\n    })\r\n    .then(data => {\r\n      this.setState({\r\n        weatherDataByGeo: data,\r\n        loading: false\r\n      });\r\n    })\r\n    .catch(err => {\r\n      console.warn('Данные не были получены, ошибка: ' + err);\r\n    })\r\n  }\r\n\r\n  //функция геолокации. Определяет текущее местоположение пользователя\r\n  geoLocation() {\r\n    if(\"geolocation\" in  navigator){\r\n      console.log('navigator');\r\n      const geo_options = {\r\n        enableHighAccuracy: true, \r\n        maximumAge        : 0, \r\n        timeout           : 27000\r\n      };\r\n\r\n      const geo_success = (position) => {\r\n        console.log(position.coords);\r\n        this.fetchDataByGeo(position.coords.latitude, position.coords.longitude)\r\n      }\r\n\r\n      const geo_err = (err) => {\r\n        console.log(err.code, err.message);\r\n        this.setState({errGeo: err});\r\n      }\r\n      \r\n      navigator.geolocation.getCurrentPosition(geo_success, geo_err, geo_options);\r\n\r\n    } else {\r\n      alert('Геолакация не поддерживается вашим браузером.'\r\n            + 'Используйте другой браузер или обновите ваш браузер до последней версии.' )\r\n    }\r\n  }\r\n \r\n  //функция валидации для поиска. Не дает добавить город, если ничего не введенно в поиск\r\n  //так же не дает добавить город, который уже есть в navbar\r\n  validate(value) {\r\n    const {cities} = this.state;\r\n    if (!value) return 'no value';\r\n\r\n    if(cities) {\r\n      for (let i = 0; i < cities.length; i++) {\r\n        if (cities[i].city === value.trim()) return 'duplicate';\r\n      }\r\n    }\r\n    \r\n    return 'true';\r\n  }\r\n\r\n  handleCityClick(activeCity) {\r\n    this.setState({activeCityId: activeCity.id, errGeo: null, searchErr: ''})\r\n  }\r\n\r\n  handleInputChange(input) {\r\n    this.setState({value: input.value});\r\n  }\r\n\r\n  handleSearchBtnClick(event) {\r\n    if (event.key === 'Enter' || event.target.id === 'searchBtn') {\r\n      const {cities, value} = this.state;\r\n      const validValue = value.slice(0,1).toUpperCase() + value.slice(1).toLowerCase();\r\n      const validateResult = this.validate(validValue);\r\n      const citiesClone = cities.slice();\r\n      \r\n      //если введеные в данные в поиск валидны, то формируем объект, который пушим в клон массива городов и изменяем состояние компонента\r\n      if (validateResult === 'true') {\r\n        const newCity = {\r\n          id: cities.length > 0 ? cities[cities.length-1].id + 1 : 1,\r\n          city: validValue\r\n        }\r\n        citiesClone.push(newCity);\r\n\r\n        localStorage.setItem('cities', JSON.stringify(citiesClone));\r\n        \r\n        this.setState({\r\n          cities: JSON.parse(localStorage.getItem('cities')),\r\n          activeCityId: newCity.id, \r\n          value: '',\r\n          searchErr: '',\r\n          errGeo: null\r\n        })\r\n      } else if (validateResult === 'duplicate') {\r\n        this.setState({value: '', searchErr: 'duplicate', errGeo: null})\r\n      } else this.setState({searchErr: 'no value', errGeo: null})\r\n    }\r\n  }\r\n\r\n  handleDeleteCityBtnClick(deleteBtn) {\r\n    const {cities} = this.state;\r\n    const citiesClone = cities.slice();\r\n    \r\n    for (let i = 0; i < citiesClone.length; i++) {\r\n      if (citiesClone[i].id === +deleteBtn.id) {\r\n        citiesClone.splice(i, 1);\r\n        localStorage.setItem('cities', JSON.stringify(citiesClone))\r\n      }\r\n    }\r\n    \r\n    this.setState({\r\n      activeCityId: deleteBtn.id - 1,\r\n      cities: JSON.parse(localStorage.getItem('cities'))\r\n    });\r\n  }\r\n\r\n  handleLocationClick(e) {\r\n    const {errGeo} = this.state;\r\n    errGeo && this.setState({errGeo: null});\r\n    this.geoLocation();\r\n  }\r\n\r\n  componentDidMount() {\r\n    alert(`\r\n    Для корректной работы приложения необходимо дать разрешение на доступ к геоданным.\r\n    (Нажмите \"разрешить\" в следующем всплывающем окне в правом углу поисковой строки браузера).\r\n    Это необходимо для автоматического определения местоположения и последующего определения\r\n    местоположения при запросе.\r\n    `)\r\n    this.geoLocation();\r\n  }\r\n\r\n  componentDidUpdate(prevProps, prevState) {\r\n    const {cities, weatherDataByGeo} = this.state;\r\n\r\n    if (prevState.weatherDataByGeo !== weatherDataByGeo) {\r\n      let duplicate = false;\r\n\r\n      //Сделано для того чтобы при нажатии на 'Мое местоположение' в navbar-е не дублировался город,\r\n      //который определен с помощью местоположения пользователя \r\n      for (let i = 0; i < cities.length; i++) {\r\n        if (cities[i].city === weatherDataByGeo.name) {\r\n          duplicate = true;\r\n          this.setState({activeCityId: cities[i].id});\r\n        }\r\n      }\r\n\r\n      //Добавляет новый город в navbar, полученный из navigator.location (авто-определения местоположения \r\n      //или при нажатии на \"Мое местоположение\"). Город добавляется только если такого города еще нет в navbar-е\r\n      if (!duplicate) {\r\n        const citiesClone = cities.slice();\r\n        const newCity = {\r\n          id: cities.length > 0 ? cities[cities.length-1].id + 1 : 1,\r\n          city: weatherDataByGeo.name\r\n        }\r\n        citiesClone.push(newCity);\r\n        \r\n        localStorage.setItem('cities', JSON.stringify(citiesClone));\r\n        this.setState({\r\n          cities: JSON.parse(localStorage.getItem('cities')),\r\n          activeCityId: newCity.id\r\n        })\r\n      }\r\n      \r\n    }\r\n\r\n  }\r\n\r\n  render() {\r\n    const {cities, activeCityId, value, searchErr} = this.state;\r\n    const { weatherDataByGeo, loading, errGeo} = this.state;\r\n    let activeCity;\r\n    cities.length && cities.forEach((item) => item.id === +activeCityId ? activeCity = item.city : '')\r\n\r\n    return (\r\n      <React.Fragment>\r\n        <header className=\"header\">\r\n          <h1 className=\"header__name\">Weather App</h1>\r\n        </header>\r\n        <hr className=\"header__line\"></hr>\r\n        <main className=\"main-wrapper\">\r\n          <AddCity  \r\n            value={value}\r\n            onChange={this.handleInputChange}\r\n            onClick={this.handleSearchBtnClick}\r\n            searchErr={searchErr}\r\n            onKeyDown={this.handleSearchBtnClick}\r\n            onLocationClick={this.handleLocationClick}\r\n          />\r\n          <div className='main-info'>\r\n            <Cities \r\n              data={cities} \r\n              onCityClick={this.handleCityClick} \r\n              activeCityId={activeCityId}\r\n              onDeleteCityBtnClick={this.handleDeleteCityBtnClick}\r\n            />\r\n            {\r\n            //Если не идет загрузка И не возникли ошибки при геолокации И есть данные о погоде,\r\n            //определенные по координатам пользователя ИЛИ выбран город в navbar-e, то показывать компонент WeatherDisplay\r\n              !loading && !errGeo && (activeCityId || weatherDataByGeo ? \r\n              <WeatherDisplay activeCity={activeCity} weatherDataByGeo={weatherDataByGeo}/> : \r\n              <div className=\"weather-display\">\r\n                <p className=\"weather-display__loader\">Выберите город</p>\r\n              </div>)\r\n            }\r\n            { loading && <Loader /> }\r\n            { errGeo && <RequestError errGeo={errGeo}/>}\r\n          </div>\r\n        </main>\r\n      </React.Fragment>\r\n    )\r\n  }\r\n}\r\n\r\nexport default App;","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\n\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n\r\n\r\n"],"sourceRoot":""}